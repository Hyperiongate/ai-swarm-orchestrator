<!DOCTYPE html>
<html lang="en">
<head>
    <!--
    =============================================================================
    INDEX.HTML - AI Swarm Unified Interface
    Shiftwork Solutions LLC
    =============================================================================
    
    CHANGE LOG:
    - January 22, 2026: Added Persistent Conversation Memory System
      * Added conversation sidebar section with past conversations list
      * Added "New Conversation" button
      * Added memory status indicator above conversation area
      * Added conversation loading, deletion, and management
      * Messages now persist across sessions via backend API
      * Conversations show title, date, message count
      * Active conversation is highlighted in sidebar
      * Integrated with existing /api/orchestrate endpoint
    
    - January 22, 2026: Refactored from single 2000+ line file into 3 files
      * CSS moved to: css/swarm-styles.css
      * JavaScript moved to: js/swarm-app.js
      * This file contains HTML structure only
      * All functionality preserved - no harm done
    
    - January 21, 2026: APPLIED ALL 5 FIXES FROM SWARM10
      * FIX #1: Added Beautiful CSS Formatting for message content
      * FIX #2: Fixed Copy Button Function
      * FIX #3: Changed API Response Field - data.actual_output â†’ data.result
      * FIX #4: Improved Document Detection
      * FIX #5: Fixed Copy Button onClick
    
    - January 19, 2026: ENHANCED FEEDBACK SYSTEM
      * Added 4 separate star ratings
      * Added 6 improvement checkboxes
      * Added "Used Output" vs "Didn't Use" submission buttons
    
    FILE STRUCTURE:
    /templates/index.html     - This file (HTML structure)
    /static/css/swarm-styles.css - All CSS styles
    /static/js/swarm-app.js   - All JavaScript functionality
    
    API ENDPOINTS USED:
    GET  /api/conversations              - List recent conversations
    POST /api/conversations              - Create new conversation
    GET  /api/conversations/<id>         - Get conversation with messages
    PUT  /api/conversations/<id>         - Update conversation metadata
    DELETE /api/conversations/<id>       - Delete conversation
    POST /api/conversations/<id>/messages - Add message manually
    POST /api/orchestrate                - Now accepts/returns conversation_id
    
    =============================================================================
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Swarm - Unified Interface | Shiftwork Solutions</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="/static/css/swarm-styles.css">
</head>
<body>
    <div class="container">
        <!-- ================================================================
             HEADER SECTION
             ================================================================ -->
        <div class="header">
            <div class="header-left">
                <h1>ğŸ¤– AI Swarm - Unified Interface</h1>
                <p>Quick tasks + Project workflows with learning feedback</p>
            </div>
            <div class="mode-switcher">
                <button class="mode-btn active" onclick="switchMode('quick')" id="quickModeBtn">
                    âš¡ Quick Task
                </button>
                <button class="mode-btn" onclick="switchMode('project')" id="projectModeBtn">
                    ğŸ“ Project
                </button>
                <button class="mode-btn" onclick="switchMode('calculator')" id="calculatorModeBtn">
                    ğŸ§® Calculator
                </button>
                <button class="mode-btn" onclick="switchMode('survey')" id="surveyModeBtn">
                    ğŸ“‹ Survey
                </button>
                <button class="mode-btn" onclick="switchMode('marketing')" id="marketingModeBtn">
                    ğŸ“¢ Marketing
                </button>
                <button class="mode-btn" onclick="switchMode('opportunities')" id="opportunitiesModeBtn">
                    ğŸ¯ Opportunities
                </button>
            </div>
        </div>
        
        <!-- ================================================================
             MAIN GRID LAYOUT
             ================================================================ -->
        <div class="main-grid">
            
            <!-- ============================================================
                 SIDEBAR
                 ============================================================ -->
            <div class="sidebar">
                
                <!-- ========================================================
                     CONVERSATIONS SECTION (NEW - Memory Feature)
                     ======================================================== -->
                <div class="conversations-section">
                    <div class="conversations-header">
                        <h3>ğŸ’¬ Conversations</h3>
                        <button class="new-conversation-btn" onclick="startNewConversation()" title="Start new conversation">
                            â• New
                        </button>
                    </div>
                    <div class="conversations-list" id="conversationsList">
                        <!-- Dynamically populated with past conversations -->
                        <div class="conversations-loading">Loading conversations...</div>
                    </div>
                </div>
                
                <!-- Stats Section (always visible) -->
                <h3>ğŸ“Š System Stats</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalTasks">0</div>
                        <div class="stat-label">Tasks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgRating">-</div>
                        <div class="stat-label">Avg Rating</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="knowledgeDocs">22</div>
                        <div class="stat-label">Documents</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="consensusAccuracy">-</div>
                        <div class="stat-label">Accuracy</div>
                    </div>
                </div>
                
                <!-- Project Info Panel (project mode only) -->
                <div class="project-info" id="projectInfo">
                    <h3 style="margin-bottom: 10px;">Current Project</h3>
                    
                    <label>Select Existing Project</label>
                    <select id="existingProjects" onchange="loadExistingProject()" style="width: 100%; padding: 8px; margin-bottom: 10px; border: 2px solid #e0e0e0; border-radius: 6px;">
                        <option value="">-- Select Project --</option>
                    </select>
                    
                    <label>Client</label>
                    <span id="clientName">No active project</span>
                    
                    <label>Phase</label>
                    <span id="projectPhase">
                        <div class="phase-indicator">Not started</div>
                    </span>
                    
                    <button onclick="startNewProject()" style="width: 100%; padding: 10px; margin-top: 10px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer;">
                        + New Project
                    </button>
                </div>
                
                <!-- Marketing Info Panel (marketing mode only) -->
                <div class="marketing-info" id="marketingInfo" style="display: none;">
                    <h3 style="margin-bottom: 10px;">Marketing Hub</h3>
                    
                    <div style="font-size: 12px; margin-bottom: 15px;">
                        <div style="font-weight: 600; margin-bottom: 5px;">Platform Status:</div>
                        <div id="platformStatus" style="padding: 10px; background: #f0f0f0; border-radius: 6px;">
                            Loading...
                        </div>
                    </div>
                    
                    <h4 style="font-size: 14px; margin-bottom: 8px;">ğŸ’¡ AI Initiative</h4>
                    <button onclick="generateMarketingIdea()" style="width: 100%; padding: 12px; margin-bottom: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 700; font-size: 14px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); transition: transform 0.2s;">
                        ğŸš€ "Hey Jim, I have an idea!"
                    </button>
                    
                    <h4 style="font-size: 14px; margin-bottom: 8px;">Quick Actions</h4>
                    <button onclick="generateSocialPost()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #0077b5; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ“ Generate LinkedIn Post
                    </button>
                    <button onclick="conductResearch()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #764ba2; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ” Market Research
                    </button>
                    <button onclick="analyzeCompetitors()" style="width: 100%; padding: 8px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ“Š Competitive Analysis
                    </button>
                </div>
                
                <!-- Calculator Panel (calculator mode only) -->
                <div class="calculator-info" id="calculatorInfo" style="display: none;">
                    <h3 style="margin-bottom: 10px;">Cost Calculator</h3>
                    
                    <h4 style="font-size: 14px; margin-bottom: 8px;">Quick Calculations</h4>
                    <button onclick="calculateOvertimeCost()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ’° Overtime Cost
                    </button>
                    <button onclick="compareHireVsOT()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #764ba2; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ‘¥ Hire vs OT
                    </button>
                    <button onclick="scheduleImpact()" style="width: 100%; padding: 8px; background: #0077b5; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ“Š Schedule Impact
                    </button>
                </div>
                
                <!-- Survey Panel (survey mode only) -->
                <div class="survey-info" id="surveyInfo" style="display: none;">
                    <h3 style="margin-bottom: 10px;">Survey Builder</h3>
                    
                    <div style="font-size: 12px; margin-bottom: 15px;">
                        <div style="font-weight: 600; margin-bottom: 5px;">Question Bank:</div>
                        <div id="questionBankStatus" style="padding: 10px; background: #f0f0f0; border-radius: 6px;">
                            Loading...
                        </div>
                    </div>
                    
                    <h4 style="font-size: 14px; margin-bottom: 8px;">Quick Actions</h4>
                    <button onclick="createNewSurvey()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        â• Create Survey
                    </button>
                    <button onclick="viewSurveyResults()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #0077b5; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ“Š View Results
                    </button>
                    <button onclick="exportSurveyData()" style="width: 100%; padding: 8px; background: #764ba2; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ“¤ Export Data
                    </button>
                </div>
                
                <!-- Opportunities Panel (opportunities mode only) -->
                <div class="opportunities-info" id="opportunitiesInfo" style="display: none;">
                    <h3 style="margin-bottom: 10px;">ğŸ¯ Opportunity Finder</h3>
                    
                    <div style="font-size: 12px; margin-bottom: 15px;">
                        <div style="font-weight: 600; margin-bottom: 5px;">Database Status:</div>
                        <div id="normativeStatus" style="padding: 10px; background: #f0f0f0; border-radius: 6px;">
                            Loading...
                        </div>
                    </div>
                    
                    <h4 style="font-size: 14px; margin-bottom: 8px;">Quick Analysis</h4>
                    <button onclick="analyzeScheduleOpportunities()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ“Š Analyze Current Schedule
                    </button>
                    <button onclick="compareToNorms()" style="width: 100%; padding: 8px; margin-bottom: 8px; background: #764ba2; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ“ˆ Compare to Industry
                    </button>
                    <button onclick="findImprovements()" style="width: 100%; padding: 8px; background: #0077b5; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        ğŸ’¡ Find Improvements
                    </button>
                </div>
                
                <!-- Quick Actions Section -->
                <h3 style="margin-top: 20px;">Quick Actions</h3>
                <ul class="quick-actions" id="quickActions">
                    <!-- Dynamically populated based on mode -->
                </ul>
                
                <!-- Generated Documents Section -->
                <h3 style="margin-top: 20px;">ğŸ“„ Documents</h3>
                <div id="documentsList" style="font-size: 12px; max-height: 200px; overflow-y: auto;">
                    <div style="color: #999; padding: 10px; text-align: center;">No documents yet</div>
                </div>
                <button onclick="refreshDocuments()" style="width: 100%; padding: 8px; margin-top: 10px; background: #f0f0f0; border: 1px solid #e0e0e0; border-radius: 6px; cursor: pointer; font-size: 12px; color: #666;">
                    ğŸ”„ Refresh
                </button>
            </div>
            
            <!-- ============================================================
                 MAIN CONTENT AREA
                 ============================================================ -->
            <div class="main-content">
                
                <!-- ========================================================
                     MEMORY STATUS INDICATOR (NEW - Memory Feature)
                     ======================================================== -->
                <div class="memory-indicator" id="memoryIndicator">
                    <div class="memory-status warning" id="memoryStatus">
                        <span class="memory-icon">âš ï¸</span>
                        <span class="memory-text">Initializing conversation memory...</span>
                    </div>
                </div>
                
                <!-- Conversation Display -->
                <div class="conversation" id="conversation">
                    <div class="message assistant">
                        <div class="message-header">
                            ğŸ¤– AI Swarm
                            <span class="mode-indicator quick" id="initialModeIndicator">âš¡ Quick Task Mode</span>
                        </div>
                        <div class="message-content">
                            <strong>Welcome to the unified AI Swarm interface!</strong>
                            
                            <p style="margin-top: 10px;">Choose your mode:</p>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li><strong>âš¡ Quick Task Mode:</strong> One-off requests, document creation, analysis</li>
                                <li><strong>ğŸ“ Project Mode:</strong> Full consulting engagements with context tracking</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>Features:</strong></p>
                            <ul style="margin-top: 5px; margin-left: 20px;">
                                <li>âœ… 22 knowledge documents (30+ years expertise)</li>
                                <li>âœ… Professional formatting</li>
                                <li>âœ… Feedback & learning on every response</li>
                                <li>âœ… Multi-AI consensus validation</li>
                                <li>âœ… Conversation memory across sessions</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Loading Indicator -->
                <div class="loading" id="loadingIndicator">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">AI Swarm is thinking... Searching knowledge base and generating response...</div>
                </div>
                
                <!-- Input Area -->
                <div class="input-area">
                    <textarea id="userInput" placeholder="Type your request here..."></textarea>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button onclick="sendMessage()">Send</button>
                        <label for="fileUpload" style="padding: 10px 20px; background: #e0e0e0; color: #333; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; text-align: center; transition: background 0.2s;">
                            ğŸ“ Upload Files
                        </label>
                        <input type="file" id="fileUpload" multiple accept=".pdf,.docx,.xlsx,.csv,.txt,.png,.jpg,.jpeg" style="display: none;" onchange="handleFileUpload(event)">
                    </div>
                </div>
                
                <!-- File Preview Area -->
                <div id="filePreview" style="margin-top: 10px; display: none;">
                    <div style="font-size: 12px; font-weight: 600; color: #667eea; margin-bottom: 5px;">Attached Files:</div>
                    <div id="fileList" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- External JavaScript -->
    <script src="/static/js/swarm-app.js"></script>
</body>
</html>

<!-- I did no harm and this file is not truncated -->
